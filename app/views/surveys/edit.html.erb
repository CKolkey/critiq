<%= render partial: "shared/sidebar" %>
<div class="main-content">

  <!-- This partial containes stuff that was in the template but I have no -->
  <!-- idea what its for, so it's commented out -->
  <%#= render partial: "shared/dashkit_top_navbar" %>

  <!-- HEADER -->
  <div class="header no-b-margin">
    <div class="container-fluid">

      <!-- Body -->
      <div class="header-body">
        <div class="row align-items-end">
          <div class="col-8">

            <!-- Pretitle -->
            <h6 class="header-pretitle">
              CRITIQ
            </h6>

            <!-- Title -->
            <h1 class="header-title">
              Create
            </h1>

          </div>
          <div class="col-4">

            <!-- Button -->


          </div>
        </div>
        <!-- / .row -->
      </div>
      <!-- / .header-body -->

    </div>
  </div>
  <!-- / .header -->

  <!-- LEFT and RIGHT panes -->
  <div class="container-fluid d-flex overflow-a">

    <h3 style="margin-top:20px;"><%= @survey.title %></h3>
    <h5 style="color: grey;"><%= @survey.description %></h5>


    <div class="all-questions">
      <%= simple_form_for @survey do |f| %>
        <div class="wrapper-title-survey">
          <%= f.input :title,
                      wrapper_html: { class: 'title-input-text' }%>
          <%= f.input :description,
                      wrapper_html: { class: 'description-input-text' } %>
        <div class="slack-channels">
          <h5>Get Critiq from your colleagues in:
          <%= f.collection_select :channel_id,
                @slackchannels,
                ->(item) { item[:id] },
                ->(item) { item[:name].capitalize }
                %></h5>
        </div>
        </div>
        <!-- nested form for creating questions -->
        <div id="questions">
          <%= f.simple_fields_for :questions do |f| %>
            <%= render 'question_fields', f: f %>
          <% end %>

            <div class="links">
              <%#= link_to_add_association 'add question', f, :questions, class:"btn btn-primary" %>
               <%= link_to_add_association '<i class="fas fa-plus-circle"></i>'.html_safe, f, :questions, class:"question-icon" %>
            </div>
        </div>
        <%= f.input :published, :as => :hidden, :input_html => { :value => "true" } %>
        <%= f.button :submit, class:"btn btn-primary create-survey-button-edit" %>
      <% end %>
    </div>



  </div>
</div>



<!-- END  -->
<%= content_for :after_js do %>
  <script>
    const clickPlus = () => {
      document.querySelector('.question-icon').click()
    }
    $( document ).ready(function(){
      clickPlus();
    })
  </script>
<% end %>
